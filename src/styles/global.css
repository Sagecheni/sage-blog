@import "tailwindcss";
@import "./typography.css";
@import "katex/dist/katex.min.css";

@custom-variant dark (&:where(.dark, .dark *));

/* FONTS */
/* @font-face {
  font-family: "Space Grotesk";
  src: url("/fonts/space-grotesk.woff2") format("woff2");
  font-weight: 300 400 600;
  font-display: swap;
}

@font-face {
  font-family: "IBM Plex Mono";
  src: url("/fonts/ibm-plex-mono.woff2") format("woff2");
  font-weight: 400 500;
  font-display: swap;
} */

/* COLOR SCHEME */
/* P5R THEME COLORS */
.dark {
  /* P5R Dark: Pure Black, White Text, Bold Red Accent */
  --background: #000000;
  --foreground: #ffffff;
  --accent: #D8000C;
}

.light {
  /* P5R Light: White Background, Black Text, Bold Red Accent */
  --background: #ffffff;
  --foreground: #000000;
  --accent: #D8000C;
}

/* CODE BLOCK */
.light {
  .astro-code,
  .astro-code span {
    color: var(--shiki-light) !important;
    background-color: var(--shiki-light-bg) !important;
    /* font-style: var(--shiki-light-font-style) !important;
    font-weight: var(--shiki-light-font-weight) !important;
    text-decoration: var(--shiki-light-text-decoration) !important; */
  }
}
.dark {
  .astro-code,
  .astro-code span {
    color: var(--shiki-dark) !important;
    background-color: var(--shiki-dark-bg) !important;
    /* font-style: var(--shiki-dark-font-style) !important;
    font-weight: var(--shiki-dark-font-weight) !important;
    text-decoration: var(--shiki-dark-text-decoration) !important; */
  }
}

/* INIT TAILWIND THEME */
@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-accent: var(--accent);

  --font-sans: "Space Grotesk Variable", "LXGW WenKai Screen";
  --font-mono: "IBM Plex Mono";
  --font-heading: "Bangers", "ZCOOL QingKe HuangYou", cursive;
}

/* BASE STYLING */
@layer base {
  /* layouts */
  html {
    @apply bg-background text-foreground selection:bg-accent selection:text-background scroll-smooth antialiased;
  }
  h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-heading);
    letter-spacing: 0.05em; /* Bangers looks better with slight spacing */
  }
  body {
    --z-old: 1;
    --z-new: 2;
    background-color: var(--background);
    background-size: 100% 100%;
    background-attachment: fixed;
  }
  .dark {
    --z-old: 2;
    --z-new: 1;
  }

  /* HOME ONLY GEOMETRY */
  .home-geometry {
    background-image:
      /* Bottom-Right Rays */
      linear-gradient(115deg, transparent 70%, #D8000C 70%, #D8000C 85%, transparent 85%),
      linear-gradient(115deg, transparent 86%, #ffffff 86%, #ffffff 87%, transparent 87%),
      /* Top-Left Rays (Symmetric) */
      linear-gradient(115deg, transparent 15%, #D8000C 15%, #D8000C 30%, transparent 30%),
      linear-gradient(115deg, transparent 13%, #ffffff 13%, #ffffff 14%, transparent 14%);
  }

  button:not(:disabled) {
    cursor: pointer;
  }
}

/* SCROLLBAR STYLING */
@layer base {
  /* Custom P5R Scrollbar */
  ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }

  ::-webkit-scrollbar-track {
    background-color: #000000;
  }

  ::-webkit-scrollbar-thumb {
    background-color: #D8000C;
    border: 2px solid #000000; /* Create a 'floating' look */
  }

  ::-webkit-scrollbar-thumb:hover {
    background-color: #ff0015;
  }

  /* P5R Selection Style */
  ::selection {
    background-color: #D8000C;
    color: #ffffff;
     text-shadow: 1px 1px 0 #000;
  }
}

/* THEME TRANSITION */
::view-transition-old(root),
::view-transition-new(root) {
  animation: none;
  mix-blend-mode: normal;
}

::view-transition-old(root) {
  z-index: var(--z-old);
}
::view-transition-new(root) {
  z-index: var(--z-new);
}

@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

.animate-blink {
  animation: blink 1s step-end infinite;
}

@keyframes fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes fade-in-up {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.animate-fade-in {
  animation: fade-in 1s ease-out forwards;
}

.animate-fade-in-up {
  animation: fade-in-up 1s ease-out 0.3s forwards;
  opacity: 0; /* consistent start state */
}

/* CALLOUTS / DIRECTIVES */
.callout {
    padding: 1rem;
    margin: 1rem 0;
    border-left: 4px solid;
    background-color: var(--background);
    color: var(--foreground);
    position: relative;
    border: 2px solid var(--foreground);
    box-shadow: 4px 4px 0px var(--foreground);
}

.callout-title {
    font-weight: bold;
    margin-bottom: 0.5rem;
    display: block;
    text-transform: uppercase;
    font-family: var(--font-heading);
    letter-spacing: 0.05em;
}

.callout.note {
    border-color: #3b82f6; /* Blue */
    box-shadow: 4px 4px 0px #3b82f6;
}
.callout.note::before {
    content: "NOTE";
    display: block;
    font-weight: bold;
    font-family: var(--font-heading);
    color: #3b82f6;
    margin-bottom: 0.5rem;
}

.callout.tip {
    border-color: #10b981; /* Green */
    box-shadow: 4px 4px 0px #10b981;
}
.callout.tip::before {
    content: "TIP";
    display: block;
    font-weight: bold;
    font-family: var(--font-heading);
    color: #10b981;
    margin-bottom: 0.5rem;
}

.callout.warning {
    border-color: #f59e0b; /* Yellow/Orange */
    box-shadow: 4px 4px 0px #f59e0b;
}
.callout.warning::before {
    content: "WARNING";
    display: block;
    font-weight: bold;
    font-family: var(--font-heading);
    color: #f59e0b;
    margin-bottom: 0.5rem;
}

.callout.important {
    border-color: #8b5cf6; /* Purple */
    box-shadow: 4px 4px 0px #8b5cf6;
}
.callout.important::before {
    content: "IMPORTANT";
    display: block;
    font-weight: bold;
    font-family: var(--font-heading);
    color: #8b5cf6;
    margin-bottom: 0.5rem;
}

.callout.caution {
    border-color: #ef4444; /* Red */
    box-shadow: 4px 4px 0px #ef4444;
}
.callout.caution::before {
    content: "CAUTION";
    display: block;
    font-weight: bold;
    font-family: var(--font-heading);
    color: #ef4444;
    margin-bottom: 0.5rem;
}

/* Citations Bubble (Custom Directive :citen) */
.citation {
    color: var(--accent);
    vertical-align: super;
    font-size: 0.75em;
    text-decoration: none;
    margin: 0 0.1rem;
    font-family: var(--font-mono);
    line-height: 0; /* Prevents messing up line height */
    cursor: pointer;
    font-weight: bold;
}
.citation:hover {
    text-decoration: underline;
}

/* Bibliography / CSL Styles */
.csl-bib-body {
    margin-top: 2rem;
    line-height: 1.6;
}

.csl-entry {
    display: flex;
    margin-bottom: 0.5rem;
    align-items: baseline; /* Align label with first line of text */
}

.csl-left-margin {
    min-width: 2.5rem; /* Space for [100] */
    margin-right: 0.5rem;
    text-align: right;
    font-family: var(--font-mono);
    color: var(--accent);
}

.csl-right-inline {
    flex: 1;
}